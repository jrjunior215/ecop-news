<div class="container_crud_edit px-3 pt-3">
    <div class="col border-bottom">
        <h1>Editnews</h1>
    </div>
    <div class="col py-3 px-3">
        <div class="row mb-4">
            <h1 class="text-center">‡πÇ‡∏ä‡∏ß‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h1>
        </div>
        <div class="row mb-4 border-top">
            <div class="col mt-3">
                <div class="mb-3">
                    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
                    <img src="" alt="Image" class="img-fluid">
                    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏π‡∏õ -->
                    <div class="form-group mt-2">
                        <label for="imageName">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</label>
                        <input type="text" class="form-control" id="imageName" name="imageName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" required>
                    </div>
                </div>
                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° form ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                <form action="/admin-ecop/editnews" method="POST">
                    <div class="mb-3">
                        <label for="title">Title EN</label>
                        <input type="text" class="form-control" id="title" name="title" placeholder="TitleEN" required>
                    </div>
                    <div class="mb-3">
                        <label for="titleTh">Title TH</label>
                        <input type="text" class="form-control" id="titleTh" name="titleTh" placeholder="TitleTH" required>
                    </div>
                    <div class="mb-3">
                        <label for="contentEn">Content En</label>
                        <textarea class="form-control" name="contentEn" id="contentEn" cols="30" rows="10" placeholder="contentEn" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="contentTh">Content Th</label>
                        <textarea class="form-control" name="contentTh" id="contentTh" cols="30" rows="10" placeholder="contentTh" required></textarea>
                    </div>
                    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° input fields ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ -->
                    <button type="submit" class="btn btn-primary">Edit</button>
                    <a type="button" class="btn btn-danger" href="/admin-ecop/viewnews">Back</a>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô fetchData() ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
        fetchData();
    });

    function fetchData() {
        // ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡πÑ‡∏≠‡∏î‡∏µ‡∏à‡∏≤‡∏Å query parameter id ‡πÉ‡∏ô URL
        const urlParams = new URLSearchParams(window.location.search);
        const newsId = urlParams.get('id');

        // URL ‡∏Ç‡∏≠‡∏á API backend
        const baseURL = "<%= process.env.BACKEND_API %>";
        const apiURL = `${baseURL}/api/news/searchNewsById?id=${newsId}`;

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API backend ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πà‡∏≤‡∏ß‡∏ï‡∏≤‡∏°‡πÑ‡∏≠‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
        fetch(apiURL)
            .then(response => response.json())
            .then(data => {
                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô showData() ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å API
                console.log("üöÄ ~ fetchData ~ data:", data);
                showData(data);
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    function showData(data) {
    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
    document.getElementById('title').value = data.data.title;
    document.getElementById('titleTh').value = data.data.titleTh;
    document.getElementById('contentEn').value = data.data.contentEn;
    document.getElementById('contentTh').value = data.data.contentTh;
    document.getElementById('imageName').value = data.data.imgLinks;

    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î URL ‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    const imageUrl = `/images/${data.data.imgLinks}.webp`;

    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡πÅ‡∏ó‡πá‡∏Å <img> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
    const imageElement = document.querySelector('.img-fluid');
    imageElement.src = imageUrl;
    imageElement.alt = 'Image';
}

</script>
